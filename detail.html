<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>INT's</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
          integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous">
    const myCarouselElement = document.querySelector('#myCarousel')

    const carousel = new bootstrap.Carousel(myCarouselElement, {
      interval: 2000,
      touch: false
    })
  </script>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Newsreader:ital,opsz,wght@0,6..72,200..800;1,6..72,200..800&display=swap");

    body {
      margin: 0;
    }

    .pass {
        text-align: center;
        color: #000;
    }

    .header {
      padding-top: 40px;
      padding-left: 3px;
      background-color: #ffffff;
      height: 90px;
      align-items: center;
      justify-content: center;
      display: flex;
    }

    .header>div {
      color: #000000;
      font-family: "Newsreader", serif;
      font-size: 3rem;
    }

    .main {
      display: flex;
      flex-direction: column;
      position: relative;
    }

    #myCarousel {
      width: 100%;
      height: 512px;
    }

    .carousel-caption {
      top: 1.5rem;
    }

    .carousel-caption>h1 {
      margin-bottom: 3rem;
    }

    #rows-container {
      display: flex;
      align-items: flex-start;
      padding-top: 50px;
      height: 600px;
    }

    .row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .col-lg-3 {
      text-align: center;
      border-style: solid;
      border-width: 1.5px;
      border-radius: 5px;
      padding: 2rem 0.5rem;
      width: 24%;
    }

    .fw-normal {
      margin-top: 2rem;
    }

    .detail {
      margin: 25px auto 0 auto;
      width: 1330px;
      height: 500px;
      padding: 80px;
      background-color: rgb(255, 253, 231);
      border-style: solid;
      border-width: 1.5px;
    }

    .update {
      margin: 0 auto;
      display: flex;
      align-items: end;

      justify-content: end;
    }

    .card {
      justify-content: center;
    }

    #a {
      color: #000;
      text-decoration: none;
    }

    .bar {
      width: 210px;
      height: 5px;
      margin-left: auto;
      margin-right: auto;
      margin-bottom: 20px;
      background-color: black;
    }
    .update-modal{
      width: 1300px;
      margin:0 auto;
      box-shadow: 0 0 10px 0 gray;
      background-color: rgb(250, 247, 198);
      transition: all 1s;
      opacity: 0;
      position: fixed;
      pointer-events: none;
      z-index: 1;
    }

    .update-modal-content hr{
      width: 1100px;
    }

    input, h5 input, p input{
      border: none;
      background-color: rgb(250, 247, 198);
    }

    .update-modal-content-button{
      display: flex;
      align-items: end;
      justify-content: end;
      width: 1115px;

    }

    .update-modal-content-button button{

    }

    .grid-container{
      display: grid;
      grid-template-columns: 1fr;
      grid-template-rows: auto auto;
    }


    #update_modal {
      grid-row: 1;
    }

    .update input{
      margin-right: 20px;
      height: 35px;
    }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import {
      collection,
      getDocs,
      getFirestore,
      addDoc,
      query,
      where,
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
    let current_href = window.location.href;
    let href = current_href.split("/").slice(-1)[0]
    let newHref = href.split("=")
    let params = decodeURIComponent(newHref[1])





    const firebaseConfig = {
      apiKey: "AIzaSyBym678ZRXfWjzc5Us-JTMV9ljzXLgtM4I",
      authDomain: "nbc-sa.firebaseapp.com",
      projectId: "nbc-sa",
      storageBucket: "nbc-sa.appspot.com",
      messagingSenderId: "479626176899",
      appId: "1:479626176899:web:5c5ddc73093628df63aeb6",
      measurementId: "G-QD9WK29W17",
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);


    $("#save").click(async function () {
      // let image = $('#image').val()
      // let title = $('#title').val()
      // let content = $('#content').val()
      // let date = $('#date').val()
      //
      // let doc = {
      //   image : image,
      //   title : title,
      //   content :content,
      //   date :date
      // }
      // let data = await getDocs(collection(db, "cards"));
      // data.forEach((doc) => {
      //   console.log(`${doc.id} => ${JSON.stringify(doc.data())}`);
      // })
    })

    let tempHtml = `<p>hello</p>`

    $('#detail_page').append(tempHtml)

    let isModal = false
    let updateModal = $("#update_modal")

    $("#update").click(async function (){
      if(!$("#password").val()) {
        alert("비밀번호를 입력해주세요")
      }else{
        const q = query(collection(db, "cards"), where("name", "==", `${params}`));
        try{
          let data = await getDocs(q);
          let pw = ""
          data.forEach((doc) => {
            pw = `${doc.data().password}`
            console.log(pw)
          })
          if (pw !== $("#password").val()) {
            console.log($("#password").val())
            console.log(pw)
            alert("비밀번호가 일치하지 않습니다")
          } else {
            if (!isModal) {
              isModal = true
              updateModal.css("opacity", 1)
              updateModal.css("pointer-events", "auto")
            } else {
              isModal = false
              updateModal.css("opacity", 0)
              updateModal.css("pointer-events", "none")
            }
          }

        }catch (error){
          console.error(error)
        }
      }

    })

    $("#save").click(async function (){
      if(isModal === false){
        isModal = true
        $("#update_modal").css("opacity", 1)
      }else{
        isModal = false
        $("#update_modal").css("opacity", 0)
        updateModal.css("pointer-events", "none")
      }
    })
  </script>
</head>

<body>
<div class="header">
  <div>INT's</div>
</div>
<div class="bar"></div>
<div class="main grid-container" id="detail_page">
  <div class="card mb-3 detail" >
    <div class="row g-0">
      <div class="col-md-4">
        <img src="https://postfiles.pstatic.net/MjAyNDA0MTZfNzgg/MDAxNzEzMjU3MDA1Mjcw.RRJD3mrFPYCIPizm_hbXKBzeGJMBCKpin9MzDZWwmz8g.mG5Gt9mTMyIpRnrkhU7sltZ6sUT-ZzlYTPuZcULWN4Ug.JPEG/KakaoTalk_20240416_174058966dd.jpg?type=w966"
             width="300" height="350" class="img-fluid rounded-start" alt="...">
      </div>
      <div class="col-md-8">
        <div class="card-body">
          <hr>
          <h3 class="card-title">김태완</h3>
          <hr>
          <h5 class="card-text"> MBTI : INTJ</h5>
          <hr>
          <p class="card-text">나만의 장점 : 남의 말에 휘둘리지 않는 자존감</p>
          <hr>
          <p class="card-text">자신의 스타일 : 깔끔하고 심플한 것을 선호</p>
          <hr>
          <p class="card-text">블로그 : <a id="a" class="card-text"
                                        href="https://blog.naver.com/kangbaekho10s"
                                        target="_blank">https://blog.naver.com/kangbaekho10s</a></p>
          <hr>
          <div class="update">
            <input class="pass" type="password" placeholder="비밀번호" id="password">
            <button type="button" class="btn btn-danger" id="update">수정하기</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="card mb-3 detail update-modal" id="update_modal" style="margin-left: 540px">
    <div class="row g-0">
      <div class="col-md-8">
        <div class="card-body update-modal-content">
          <hr>
          <h3 class="card-text">이름 : <input type="text" placeholder="변경 전 이름"/></h3>
          <hr>
          <h5 class="card-text"> MBTI : <input type="text" placeholder="변경 전 MBTI"></h5>
          <hr>
          <p class="card-text">나만의 장점 : <input type="text" placeholder="장점"></p>
          <hr>
          <p class="card-text">자신의 스타일 : <input type="text" placeholder="스타일"></p>
          <hr>
          <p class="card-text">블로그 : <input type="text" placeholder="스타일"></p>
          <hr>
          <p class="card-text">이미지 : <input type="text" placeholder="이미지 주소"></p>
          <hr>
        </div>
        <div class="update-modal-content-button">
          <button type="button" class="btn btn-danger" id="save">저장하기</button>
        </div>
      </div>
    </div>
  </div>

  <div class="container" id="rows-container">
    <div class="row" style="width: 1500px">
      <div class="col-lg-3">
        <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
             xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder"
             preserveAspectRatio="xMidYMid slice" focusable="false">
          <title>Placeholder</title>
          <rect width="100%" height="100%" fill="var(--bs-secondary-color)"></rect>
        </svg>
        <h2 class="fw-normal">김태완</h2>
        <p><a class="btn btn-secondary" href="#">View details »</a></p>
      </div>
      <!-- /.col-lg-3 -->
      <div class="col-lg-3">
        <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
             xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder"
             preserveAspectRatio="xMidYMid slice" focusable="false">
          <title>Placeholder</title>
          <rect width="100%" height="100%" fill="var(--bs-secondary-color)"></rect>
        </svg>
        <h2 class="fw-normal">오지석</h2>
        <p><a class="btn btn-secondary" href="#">View details »</a></p>
      </div>
      <!-- /.col-lg-3 -->
      <div class="col-lg-3">
        <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
             xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder"
             preserveAspectRatio="xMidYMid slice" focusable="false">
          <title>Placeholder</title>
          <rect width="100%" height="100%" fill="var(--bs-secondary-color)"></rect>
        </svg>
        <h2 class="fw-normal">김도균</h2>
        <p><a class="btn btn-secondary" href="#">View details »</a></p>
      </div>
      <!-- /.col-lg-3 -->
      <div class="col-lg-3">
        <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
             xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder"
             preserveAspectRatio="xMidYMid slice" focusable="false">
          <title>Placeholder</title>
          <rect width="100%" height="100%" fill="var(--bs-secondary-color)"></rect>
        </svg>
        <h2 class="fw-normal">이수진</h2>
        <p><a class="btn btn-secondary" href="#">View details »</a></p>
      </div>
    </div>
  </div>
</div>
</body>

</html>
